{{- $secret := "obc-observability-bucket-creds" }}
{{- $secretData := .Files.Get (printf "secrets/%s.json" $secret) | b64dec | fromJson }}
{{- $value := index $secretData.data.BucketInfo "access_key" }}
---
apiVersion: v1
kind: Secret
metadata:
  name: thanos-test-secret
  namespace: open-cluster-management-observability
type: Opaque
stringData:
  bucket: {{ $value }}
  test: {{ fromSecret "cosi" "objectstorage-provisioner" "ENDPOINT" }}


